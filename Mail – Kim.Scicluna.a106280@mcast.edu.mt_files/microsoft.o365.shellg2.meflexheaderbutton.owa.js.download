try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = (new Date()).getTime();
function MeFlexHeaderButtonComponent(){}MeFlexHeaderButtonComponent.$$cctor=function(){_a.t.a().a(MeFlexHeaderButtonComponent)};MeFlexHeaderButtonComponent.prototype={b:function(n,t,i){var r=this;n.b(_o365sg2c.d,function(){return new _o365sg2pflex.b}).b(_o365sg2c.d).a()},a:function(){return null}};Type.registerNamespace("_o365sg2pflex");_o365sg2pflex.b=function(){_o365sg2pflex.b.resolveInheritance();this.i=this.R;this.a=this.cl;_o365sg2pflex.b.initializeBase(this)};_o365sg2pflex.b.prototype={L:null,Z:null,bj:null,bk:null,X:!1,ba:0,Y:null,T:null,bt:null,bi:0,j:function(){return this.L},t:function(n){this.L!==n&&(this.L=n);return n},e:function(){return this.Z},bu:function(n){if(this.Z!==n){this.Z=n;this.bw("UserDisplayName")}return n},g:function(){return this.bj},bv:function(n){this.bj!==n&&(this.bj=n);return n},o:function(){return!1},p:function(){return this.bk},bE:function(n){if(this.bk!==n){this.bk=n;this.bw("UserEmail")}return n},l:function(){return this.X},bR:function(n){if(this.X!==n){this.X=n;this.bw("IsSkypeDisabled")}return n},k:function(){return this.ba},f:function(n){if(this.ba!==n){this.ba=n;this.bw("UserPresence")}return n},P:null,b:function(){return this.P},B:null,c:function(){return this.B},s:function(n){this.bt!==n&&(this.bt=n);return n},n:function(){return this.w},h:function(n){this.w!==n&&this.y(n);return n},m:function(){return this.bi},d:function(n){if(this.bi!==n){this.bi=n;this.bw("MenuState")}return n},q:function(n,t){var r;try{r=n}catch(f){throw _o365cl.a.a(415006,"userPhotoViewModels",6,1);}var i;try{i=t}catch(u){throw _o365cl.a.a(415007,"rightMenusViewModel",6,1);}this.bL(r,i)},bL:function(n,t){this.T=n;this.Y=t;if(!this.x()||!this.x().b())throw _o365cl.a.b(409845,1,6);this.x().a()&&(this.x().a().IsConsumerShell&&this.x().a().NotManagedEmailAddress?this.bE(this.x().a().NotManagedEmailAddress):this.bE(this.x().a().UPN));this.F("O365_MeFlexPane_ButtonID");try{this.bF(this.x().b())}catch(i){O365.Log.WriteShellLog(411324,6,1,0,i);throw i;}},bF:function(n){this.bM(n.UserDisplayName,n.TruncatedUserDisplayName);this.r(_s1.ShellG2Strings.l_ShellCore_MeTile_Aria_Text);this.bR(this.x().a().LyncIntegrationDisabled);this.f(0);this.bQ();this.bG(n)},bQ:function(){if(this.T.length>0){this.P=this.T[0];if(this.P){var n=this;this.P.j=function(){n.B&&n.B.d()};try{this.P.i()}catch(i){O365.Log.WriteShellLog(409847,6,1,0,i);throw i;}}if(this.T.length>1){this.B=this.T[1];if(this.B)try{this.B.i()}catch(t){O365.Log.WriteShellLog(409848,6,1,0,t);throw t;}}}},bM:function(n,t){if(n||t){this.bu(t||n);this.bv(n)}else if(this.x().a()&&this.x().a().UPN)if(this.x().a().IsConsumerShell&&this.x().a().NotManagedEmailAddress){this.bu(this.x().a().NotManagedEmailAddress);this.bv(this.x().a().NotManagedEmailAddress)}else{this.bu(this.x().a().UPN);this.bv(this.x().a().UPN)}else O365.Log.WriteShellLog(175144,1,1,0)},bG:function(n){this.t(new Array(0));if(n){var t=new Array(0);if(n.AboutMeLink){var h=this;this.Y.a(t,n.AboutMeLink,function(){O365.Log.WriteShellLog(300934,1,1,0);O365.Log.a("AboutMe","MePane","NavLink",null,1,1);return!0})}if(this.x().a().MyAccountEnabled){var s=this;var u=new _fm.o(_s1.ShellG2Strings.l_ShellCore_MyAccount_Title_Text,null,new _ff.p(function(n){O365.Log.WriteShellLog(406639,1,1,0);O365.Log.a("MyAccount","MePane","NavLink",null,1,1)},_ff.c.a),this.x().a().PortalUrl+this.x().a().MyAccountUrl,"_self");u.U("O365_SubLink_ViewAccount");u.w(_s1.ShellG2Strings.l_ShellCore_MyAccount_Title_Text);t.push(u)}if(n.CurrentWorkloadUserSubLinks&&n.CurrentWorkloadUserSubLinks.length>0)for(var e=n.CurrentWorkloadUserSubLinks,o=e.length,r=0;r<o;++r){var f=e[r];f&&this.Y.a(t,f,null)}if(n.SignOutLink){var i=this;this.Y.a(t,n.SignOutLink,function(){O365.Log.a("SignOut","MePane","NavLink",null,1,1);if(i.L)for(var n=0;n<i.L.length;n++)if(i.L[n])try{i.L[n]()}catch(t){t.message=_o365su.d.a(t.message);O365.Log.WriteShellLog(300442,6,1,0,n,t)}return!0})}this.be(new _fm.e(t));_o365sg2c.j.b(this);_o365sg2c.j.a(this.v)}}};_o365sg2pflex.c=function(n){_o365sg2pflex.c.initializeBase(this,[n]);this.y("MeFlexPaneHeaderButtonView")};_o365sg2pflex.a=function(){};_o365sg2pflex.a.$$cctor=function(){_o365sg2pflex.a._I()};_o365sg2pflex.a.B=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <img/> </div><div> <div class='o365cs-mfp-header-img-container o365cs-mfp-circular-small'></div> </div><div>  <div class='o365cs-mfp-header'> <div class='o365cs-mfp-header-displayname o365cs-rsp-tn-hide o365cs-mfp-header-displayname-wrap'> <span class='o365cs-topnavText'> </span> </div> <div class='o365cs-nav-button o365cs-mfp-header-img'>  <div class='o365cs-mfp-doughboy-container'> <span class='ms-bgc-nt ms-fcl-w o365cs-mfp-doughboy o365cs-mfp-circular-small'></span> </div>  <div></div>  <div class='o365cs-mfp-header-img-container o365cs-mfp-circular-small'></div> <div autoid=\"__Microsoft_O365_ShellG2_MeFlexHeaderButton_Owa_templates_cs_0\" class='o365cs-mfp-presenceButton'></div> </div> </div> <div class='o365cs-flexPane-unseenitems'> <span class='o365cs-flexPane-unseenCount'></span> <span class='o365cs-flexPane-unseenCount'></span> </div> </div><div> <button type='button' class='o365cs-nav-item o365cs-nav-button o365cs-mfp-headerbutton ms-bgc-tdr-h'></button> </div><div> <div></div> </div>";_j.i.a().appendChild(n);return n};_o365sg2pflex.a.f=function(n){return n.B};_o365sg2pflex.a.q=function(n){return n.f};_o365sg2pflex.a.r=function(n){return n.g};_o365sg2pflex.a.p=function(n){return n.a};_o365sg2pflex.a.o=function(n){return n.b};_o365sg2pflex.a.k=function(n){return n.P};_o365sg2pflex.a.K=function(n){return n.Z};_o365sg2pflex.a.x=function(n){return n.J};_o365sg2pflex.a.z=function(n){return n.A()};_o365sg2pflex.a.J=function(n){return n.X};_o365sg2pflex.a.c=function(n){return n.ba};_o365sg2pflex.a.A=function(n){return n.O};_o365sg2pflex.a.y=function(n){return n.bg};_o365sg2pflex.a.P=function(n){return n.bN()};_o365sg2pflex.a.Q=function(n){return n.W};_o365sg2pflex.a.M=function(n){return n.K};_o365sg2pflex.a.w=function(n){return n.w};_o365sg2pflex.a.N=function(n){return n.S()};_o365sg2pflex.a.L=function(n){return n.bm()};_o365sg2pflex.a.I=function(n){return n.i()};_o365sg2pflex.a.O=function(n){return n.U};_o365sg2pflex.a.s=function(n,t){n.g(t)};_o365sg2pflex.a.t=function(n,t){n.i(t)};_o365sg2pflex.a.v=function(n,t){n.a(t)};_o365sg2pflex.a.u=function(n,t){n.b=t};_o365sg2pflex.a.e=function(n,t){n.K(t)};_o365sg2pflex.a.n=function(n,t){n.a(t)};_o365sg2pflex.a.m=function(n,t){n.a(t)};_o365sg2pflex.a.D=function(n,t){n.T(t)};_o365sg2pflex.a.H=function(n,t){n.bl(t)};_o365sg2pflex.a.G=function(n,t){n.O(t)};_o365sg2pflex.a.F=function(n,t){n.fd(t)};_o365sg2pflex.a.C=function(n,t){n.Q(t)};_o365sg2pflex.a.E=function(n,t){n.l=t};_o365sg2pflex.a.j=function(){_o365sg2pflex.a.g||(_o365sg2pflex.a.g=new _fc.j);return _o365sg2pflex.a.g};_o365sg2pflex.a.l=function(){_o365sg2pflex.a.h||(_o365sg2pflex.a.h=new _fc.l);return _o365sg2pflex.a.h};_o365sg2pflex.a.b=function(){_o365sg2pflex.a.i||(_o365sg2pflex.a.i=new _o365sg2c.w);return _o365sg2pflex.a.i};_o365sg2pflex.a._I=function(){var r="MeFlexPaneHeaderButtonView._tid1._tid2._tid3._tid4";new _j.d(r,function(){_o365sg2pflex.a.a[r]===undefined&&(_o365sg2pflex.a.a[r]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pflex.a.u,0,null,null,0,4],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pflex.a.f,_o365sg2pflex.a.q],null,"LoadCommand",null,_o365sg2pflex.a.s,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pflex.a.f,_o365sg2pflex.a.r],null,"LoadErrorCommand",null,_o365sg2pflex.a.t,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pflex.a.f,_o365sg2pflex.a.p],null,"Source",null,_o365sg2pflex.a.v,1,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[0].cloneNode(!0);var n=new _o365sg2c.f(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var u="MeFlexPaneHeaderButtonView._tid1._tid2._tid3";new _j.d(u,function(){_o365sg2pflex.a.a[u]===undefined&&(_o365sg2pflex.a.a[u]=[[[-1,0,["SecondaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pflex.a.f,_o365sg2pflex.a.o],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.j(),null,!0]]]);var t=_o365sg2pflex.a.d.childNodes[1].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid3._tid4");return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var f="MeFlexPaneHeaderButtonView._tid1._tid2._tid5";new _j.d(f,function(){_o365sg2pflex.a.a[f]===undefined&&(_o365sg2pflex.a.a[f]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pflex.a.u,0,null,null,0,4],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pflex.a.k,_o365sg2pflex.a.q],null,"LoadCommand",null,_o365sg2pflex.a.s,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pflex.a.k,_o365sg2pflex.a.r],null,"LoadErrorCommand",null,_o365sg2pflex.a.t,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pflex.a.k,_o365sg2pflex.a.p],null,"Source",null,_o365sg2pflex.a.v,1,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[0].cloneNode(!0);var n=new _o365sg2c.f(t.children[0]);n.N(!0);return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var n="MeFlexPaneHeaderButtonView._tid1._tid2";new _j.d(n,function(){_o365sg2pflex.a.a[n]===undefined&&(_o365sg2pflex.a.a[n]=[[[-1,0,["UserDisplayName"],[_o365sg2pflex.a.K],null,"Text",null,_o365sg2pflex.a.n,1,null,null,null],[-1,5,["IsDisabled"],[_o365sg2pflex.a.x],null,"o365cs-nav-itemDisabled",null,null,0,null,null,null],[-1,5,["IsSelected"],[_o365sg2pflex.a.z],null,"o365cs-topnavText",null,null,0,_o365sg2pflex.a.j(),null,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pflex.a.m,0,null,null,null,_o365sg2c.b.b]],[[-1,0,["SecondaryUserPhotoViewModel"],[_o365sg2pflex.a.f],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.l(),null,!0]],[[-1,0,["PrimaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pflex.a.k,_o365sg2pflex.a.o],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.j(),null,!0]],[[-1,0,["IsSkypeDisabled"],[_o365sg2pflex.a.J],null,"IsHidden",null,_o365sg2pflex.a.e,1,null,null,!0],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--question",null,null,0,_o365sg2pflex.a.b(),0,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeUnkown",null,null,0,_o365sg2pflex.a.b(),0,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeOffline",null,null,0,_o365sg2pflex.a.b(),1,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeCheck",null,null,0,_o365sg2pflex.a.b(),2,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeAvailable",null,null,0,_o365sg2pflex.a.b(),2,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeClock",null,null,0,_o365sg2pflex.a.b(),3,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeAway",null,null,0,_o365sg2pflex.a.b(),3,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeBusy",null,null,0,_o365sg2pflex.a.b(),4,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"ms-Icon--skypeMinus",null,null,0,_o365sg2pflex.a.b(),6,null],[-1,5,["UserPresence"],[_o365sg2pflex.a.c],null,"o365cs-mfp-skypeDND",null,null,0,_o365sg2pflex.a.b(),6,null]],null,[[-1,0,["UnseenCount"],[_o365sg2pflex.a.A],null,"Text",null,_o365sg2pflex.a.n,1,null,null,null],[-1,0,["UnseenCount"],[_o365sg2pflex.a.A],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.l(),null,!0],[-1,5,["IsReverseColor"],[_o365sg2pflex.a.y],null,"ms-fcl-tdr ms-bgc-w o365cs-flexPane-unseenCountBorder:ms-fcl-w ms-bgc-tdr",null,null,0,null,null,null],[-1,5,["IsOval"],[_o365sg2pflex.a.P],null,"o365cs-flexPane-unseenCountOval",null,null,0,null,null,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pflex.a.m,0,null,null,null,_o365sg2c.b.e],[-1,0,["ShowUnseenIndicator"],[_o365sg2pflex.a.Q],null,"IsHidden",null,_o365sg2pflex.a.e,1,_o365sg2pflex.a.j(),null,!0],[-1,5,["IsReverseColor"],[_o365sg2pflex.a.y],null,"ms-fcl-tdr ms-bgc-w o365cs-flexPane-unseenCountBorder:ms-fcl-w ms-bgc-tdr",null,null,0,null,null,null]]]);var t=_o365sg2pflex.a.d.childNodes[2].cloneNode(!0);var e=new _fc.d(_j.a.a(t,[1,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var h=new _fc.a(_j.a.a(t,[1,0]));var s=new _j.i(t.children[1]);var o=new _j.c(_j.a.a(t,[0,1,3]));var i=new _j.c(_j.a.a(t,[0,1,2]));i.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid5");var r=new _j.c(_j.a.a(t,[0,1,1]));r.y("MeFlexPaneHeaderButtonView._tid1._tid2._tid3");var u=new _fc.d(_j.a.a(t,[0,1,0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));u.N(!0);var f=new _fc.a(_j.a.a(t,[0,0,0]));f.F(47);return new _j.a(t,[f,u,r,i,o,s,h,e])},"",_o365sg2pflex.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var t="MeFlexPaneHeaderButtonView._tid1";new _j.d(t,function(){_o365sg2pflex.a.a[t]===undefined&&(_o365sg2pflex.a.a[t]=[[[-1,0,["IsHidden"],[_o365sg2pflex.a.M],null,"IsHidden",null,_o365sg2pflex.a.e,1,null,null,!0],[-1,0,["Command"],[_o365sg2pflex.a.w],null,"ClickCommand",null,_o365sg2pflex.a.D,1,null,null,null],[-1,0,["Title"],[_o365sg2pflex.a.N],null,"Title",null,_o365sg2pflex.a.H,1,null,null,null],[-1,0,["AriaId"],[_o365sg2pflex.a.L],null,"AriaId",null,_o365sg2pflex.a.G,1,null,null,null],[-1,0,["IsDisabled"],[_o365sg2pflex.a.x],null,"AriaDisabledState",null,_o365sg2pflex.a.F,1,null,null,!1],[-1,0,["AriaLabel"],[_o365sg2pflex.a.I],null,"AriaLabel",null,_o365sg2pflex.a.C,1,null,null,null],[-1,5,["IsSelected"],[_o365sg2pflex.a.z],null,"o365cs-spo-topbarMenuOpen ms-fcl-b ms-bgc-nlr:o365cs-topnavText ms-bgc-tdr-h",null,null,0,null,null,null],[-1,5,["AppButtonHighlighted"],[_o365sg2pflex.a.O],null,"ms-bgc-tdr",null,null,0,null,null,null]]]);var r=_o365sg2pflex.a.d.childNodes[3].cloneNode(!0);var n=new _fc.b(r.children[0]);n.F(10);var u=new _fc.g;var i=new _fc.c;i.U(_j.f.a(["Command"],[_o365sg2pflex.a.w],null,"Command",null,_o365sg2pflex.a.E,1));i.j("DOWNARROW");u.a([i]);n.C([u]);n.y("MeFlexPaneHeaderButtonView._tid1._tid2");return new _j.a(r,[n])},"",_o365sg2pflex.b,_o365sg2pflex.c,function(n){return new _o365sg2pflex.c(n)},!1,!0,!1,0,_o365sg2pflex.a.a);var i="MeFlexPaneHeaderButtonView";new _j.d(i,function(){_o365sg2pflex.a.a[i]===undefined&&(_o365sg2pflex.a.a[i]=[null]);var t=_o365sg2pflex.a.d.childNodes[4].cloneNode(!0);var n=new _o365sg2pflex.c(t.children[0]);n.y("MeFlexPaneHeaderButtonView._tid1");return new _j.a(t,[n])},"",_o365sg2pflex.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pflex.a.a)};MeFlexHeaderButtonComponent.registerClass("MeFlexHeaderButtonComponent",null,_a.jb,_j.cd);_o365sg2pflex.b.registerClass("_o365sg2pflex.b",_o365sg2c.l,_o365sg2c.d);_o365sg2pflex.c.registerClass("_o365sg2pflex.c",_j.c);MeFlexHeaderButtonComponent.$$cctor();_o365sg2pflex.a.d=_o365sg2pflex.a.B();_o365sg2pflex.a.g=null;_o365sg2pflex.a.h=null;_o365sg2pflex.a.i=null;_o365sg2pflex.a.a={};_o365sg2pflex.a.$$cctor();
window.scriptsLoaded['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.shellg2.meflexheaderbutton.owa.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
