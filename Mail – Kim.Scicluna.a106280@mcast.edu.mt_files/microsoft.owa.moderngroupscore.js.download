try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime();
Type.registerNamespace("_xc");_xc.l=function(){};_xc.l.registerInterface("_xc.l");_xc.i=function(n,t,i,r,u,f,e,o,s,h){_xc.i.initializeBase(this,[n,t,i,r,u,f,o,null,e,h,-1,!1]);this.r.explicitLogonUser=n.a.Mailbox.EmailAddress;this.bt=s;this.bs=!!h};_xc.i.prototype={bt:null,by:function(){return this.bt},bn:function(n){return n?_xc.i.b:_xc.i.a},bs:!1};function ModernGroupsCoreComponent(){}ModernGroupsCoreComponent.$$cctor=function(){_a.t.a().a(ModernGroupsCoreComponent)};ModernGroupsCoreComponent.prototype={b:function(n,t,i){n.e(_xc.r).b(_h.cO).a();var f=this;n.b(_xs.k,function(){return new _xc.v(n.a(_a.f))}).a();var u=this;n.b(_mgn.P,function(){return new _xc.g(n.a(IGroupConversationItemPartsFactory),n.a(_h.cO),n.a(_xs.k))}).a();var r=this;n.b(_y.ei,function(){return new _xc.j(n.a(_y.a),n.a(_j.j),n.a(_a.bo),n.a(_bc.a),n.a(_y.s),n.c(_xc.l),n.c(_xs.h),n.a(_a.f))}).a();_a.c.m("NavigateFromMeToWeSpace")},a:function(){return null}};_xc.n=function(){};_xc.n.registerInterface("_xc.n");_xc.x=function(){};_xc.x.registerInterface("_xc.x");_xc.t=function(n){this.c=n};_xc.t.prototype={c:null,b:function(n){var i=n;var t="";i==="previously-loaded"&&(this.c&&this.c.a().bw().Enabled?t=_nbs.a.Lk:this.c&&this.c.a().bx().Enabled&&(t=_nbs.a.BP));return new _xz.a(t,i,!!this.c&&this.c.a().bx().Enabled)},a:function(){return!1}};_xc.u=function(n,t){var i=this;_xc.u.initializeBase(this,[new _xc.t(t),function(n){return n}]);this.d=n};_xc.u.prototype={d:null,i:function(n){var r=n;var i=this.d.eA(r);var u=i?"previously-loaded":"newly-loaded";var t=this.c.c(u);i||t.b(!0);return t}};_xc.v=function(n){this.d=Function.createDelegate(this,this.b);this.c=n};_xc.v.prototype={c:null,b:function(n,t,i){return this.c&&this.c.a().O().Enabled?new _xc.o(n,t,i,this.c):new _xc.h(n,t,i,this.c)}};_xc.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.ps=Function.createDelegate(this,this.sJ);this.ko=Function.createDelegate(this,this.pw);this.pr=Function.createDelegate(this,this.sy);this.mS=Function.createDelegate(this,this.st);this.mT=Function.createDelegate(this,this.sx);_xc.d.resolveInheritance();this.dC=this.sK;_xc.d.initializeBase(this,[n,t,i,r,u,null,f,o,p,e,null,h,null,null,null,c,null,null,null,null,null,null,a,null,v,null,!1]);this.gF=!0;this.bl(this.gj());this.dG(!0);this.er(_xc.d.b);this.nc=s;this.mW=new _y.dZ(n.a());this.eW.b(_mgn.D,this.mT);this.mZ=l;this.na=a;this.nb=y;this.hP=!1;this.hg=new _xc.k(this.eW,r,_mgs.X.b,_mgs.X.BY);this.hg.apcl("IsClosed",this.mS)};_xc.d.e=function(n,t){var i=!0;return _xc.d.c(i)};_xc.d.c=function(n){return n?"GroupConversationFeedView":"GroupConversationListView"};_xc.d.prototype={mW:null,nc:null,na:null,nb:null,gF:!1,hi:null,kr:null,iW:null,mZ:null,hP:!1,ks:null,mX:!1,gE:null,hN:0,hO:null,iV:null,dE:function(){this.iV={};var n=[];this.hK(_u.R.N,this.iI,3,null,n);this.hK(_u.R.UN,this.io,4,null,n);this.hK("",null,5,new _fm.i,n);this.hK(_u.R.Ex,this.mU,0,null,n);this.hK(_u.R.OI,this.K(),1,null,n);this.hK(_u.R.Sd,this.L(),2,null,n);if(this.gE){this.gE.p.g();this.gE.p.m(n)}else this.gE=new _fm.e(n);this.gE.t=this.pr},mU:null,dF:function(n){this.mU=n;return n},sF:function(n){if(this.gF!==n){this.gF=n;this.eC("IsFeedView")}return n},dG:function(n){this.mX=n;this.eC("FocusItemOnSelect");return n},fA:function(){return this.hi},bt:function(n){if(this.hi!==n){this.hi=n;this.px(n);if(n){this.F(null);this.eu(_g.y.f(this.hi),null);this.hO=null;this.kp=_mr.S.a(this.fe,this.hi.bD.SmtpAddress,this.nb)}else this.eu(null,null);this.gj()&&this.eC("ShowNewConversationLabel");this.eC("RefreshButtonAriaLabel");this.eC("ModernGroup")}return n},sJ:function(n){var i=this.eR;var t=new _h.cv;t.l(i.bD.FolderId);t.f([i]);t.o=0;t.r=n;_a.g.a.a(t)},hh:function(){return this.eB.a().x.length},sw:function(n){this.iU=!1;if(!this.fx)return _nbs.a.jG;if(this.fx===1)return _nbs.a.jS;var t;if(this.fx>99){t="99+";this.iU=!0}else if(n||this.hh()>0&&!(this.hh()%this.go())&&this.hh()===this.fx){t=this.fx+"+";this.iU=!0}else t=this.fx.toString();return String.format(_nbs.a.pj,t)},iU:!1,fx:0,sG:function(n){if(this.ks!==n){this.ks=n;this.eC("NewConversationLabelText")}return n},ky:function(n,t){var i=_lv.h.prototype.ky.call(this,n,t);if(i){var r=this.fA();i.R=r.bD.SmtpAddress}return i},gc:function(n){return this.gr&&this.gj()?new _xc.u(this,this.fe):null},hu:function(){var i=null;if(this.eR){var n=this.eR;var t=new _g.i;t.cX(n.bD.ConversationTopic);if(n.a()&&n.a().b()>0){t.ca(n.a().a(0));i=t}}return i},oR:function(n){var i;var u=_a.c.b(_a.a.cI,"ReadingPanePopOut",!0,(i=new _a.L,i.a=!0,i));u.p(_xc.d.d);var f={};f.ItemID=n.bD.ItemId.Id;var t=new _y.n(!0);t.d(this.eL.b);t.f(this.ge());t.b(this.gh);t.c(!1);t.a(n);t.e(_h.n.a(this.j()));t.i(this.im);t.bF(u);this.kq()&&t.j(this.kq().bD.SmtpAddress);var r=_h.a.a(n.bD.ParentFolderId);r&&t.g(r.bD.DisplayName);t.h(this.fF);this.fb.g(IModernItemReadingPaneViewModelPopOutFactory,null,f,_bc.d.a(),t,!1)},kq:function(){return this.kr},px:function(n){if(this.kr!==n){this.kr=n;this.eC("ModernGroupFromSelectedConversation")}return n},iT:!1,su:function(){return this.mW.j(this.hi)},dD:function(){return this.hL()?!this.pu():!this.C()||this.C()===1},hM:function(){return this.fe.a().bw().Enabled&&!this.hL()},iX:function(){return this.fe.a().bx().Enabled&&!this.hL()},gj:function(){return this.hM()||this.iX()},pv:function(){return!this.fA().isMember&&(this.fA().b===1||this.fA().b===2)},sv:function(){return this.hM()&&!this.pv()||this.iX()&&this.fx>0&&!this.pv()},pu:function(){if(this.hN===2||this.hN===3)return!0;if(this.eK&&_xs.c.isInstanceOfType(this.eK)){var n=this.eK;return n.d()}return!1},hL:function(){return!!this.eK&&this.eK.e()||!!this.hN},dH:function(n){if(this.hN!==n){this.hN=n;this.eG("IsCrossGroupSearch","IsInSearchMode")}return n},mV:!1,bu:function(n){this.mV=n;return n},dI:function(n){if(this.hP!==n){this.hP=n;this.eC("ShowSuggestPublicGroupsSearchBar")}return n},hg:null,go:function(){return this.gF?15:_lv.b.prototype.go.call(this)},lB:function(){return"ModernGroupConversationSearch"},kp:!1,eA:function(n){n.G=n.h().p().b(this.fA().o().p())<=0;return n.G},cs:function(n,t){n===3&&this.hP&&this.dB();this.ft=!1;this.iL(t);this.gi(!1);this.mx()},dA:function(){this.dH(0)},dB:function(){this.dI(!1)},ni:function(n){return new _xc.c(n,this.fA(),this,this.fb,this.fe,this.kp,this.na)},oi:function(){return this.hb},nj:function(n,t){var r=!!t&&!_j.h.a(t.i);this.sF(!r);var i=_xc.d.c(this.gF);return new _xc.m(n,t,this.fi,this.gF,i,this.fA())},kz:function(n){var t;var r,i;var u=(i=_h.c.v(n,this.ja,this.nc,this.mZ.d,r={val:t}),t=r.val,i);this.ft=t;return u},oQ:function(n,t){this.eC("GroupTable");this.kt(!1)},eF:function(){this.eW.c(_mgn.D,this.mT);this.hg&&this.hg.rpcl("IsClosed",this.mS);this.eK&&this.eK.u("InSearchMode",this.ko);_lv.b.prototype.eF.call(this)},kB:function(n,t,i,r){this.fP?n.M(this.iW,t,i,r):_lv.h.prototype.kB.call(this,n,t,i,r)},oo:function(n,t,i,r,u){var f=this.eK.b();return this.eK.f().g(n,t,i,r,!0,u,[f.c()],f.d()?10:0,f.a())},pj:function(){return this.eB.i()||this.iT},oP:function(){this.eC("ShouldShowCompose");if(_xs.c.isInstanceOfType(this.eK)){var n=this.eK;n.z()}},ms:function(n){this.mV||_lv.b.prototype.ms.call(this,n)},oK:function(n){n&&_xt.h.isInstanceOfType(n)&&this.eK&&this.sB(n)},sB:function(n){this.fe.a().fc().Enabled&&!n.f()&&this.sA(n)},sA:function(n){var r=this.eK.b();var t=this.eK.f().c(n.c(),n.a(),n.b(),null,null,!0,n.e(),[3],1,r.a());if(t){var i=this;t.e(function(t,r){i.sz(r.a(),n.d(),r.b(),3,1)});t.a()}},sx:function(n){if(this.eB){var t=this.eB.l(n.a);if(t){this.F(t);_mgn.h.a()}else{this.ct(n.a,n.b);this.eB.M(n.a,new _h.m(0,this.go()),200,null)}}},sz:function(n,t,i,r,u){if(this.hL()&&u===1&&this.fe.a().fc().Enabled&&r===3&&n&&n.b()>=1){this.hg.v(n,t,i,i,r);this.dI(!0)}},st:function(n,t){this.dB()},mn:function(){this.eK&&this.eK.u("InSearchMode",this.ko)},mp:function(){this.eK&&this.eK.q("InSearchMode",this.ko);this.eC("ShowNewConversationLabel");this.bl(this.gj());this.eC(_lv.b.e);this.pw(null,"IsInSearchMode")},ew:function(){return this.gj()},mo:function(n,t){_lv.b.prototype.mo.call(this,n,t);t.c===2&&this.sD(t.b);this.sE();this.gj()&&(this.hM()&&this.iU&&(!t.c||t.c===2||t.c===1)&&t.f===4?this.kt(!0):this.kt(!1))},kt:function(n){if(this.gj()&&this.eB&&this.eB.a()){var i;if(this.fx>0&&this.fx<=this.hh()&&!this.eA(this.eB.a().x[this.fx-1]))i=this.fx;else{i=0;this.fx=0}for(var t=i;t<this.hh();t++)if(this.eA(this.eB.a().x[t]))break;else this.fx++;if(this.hM()){this.sG(this.sw(n));this.eC("UnseenConversationCount")}this.iX()&&this.eC("ShowNewConversationLabel")}},sH:function(){var n=this;_j.m.a().a(_a.a.h,"ShowStartNewConvGroupOobe",function(){var t;n.eW.a(IGroupsOobeEvent,(t=new _mgn.p,t.b=1,t))},1e3)},sI:function(){if(this.fP){var n=null;if(this.eB&&this.hh()>0){n=this.eB.l(this.iW);if(n){this.bo(1);this.bb(0);this.kf(n);this.bb(1);this.bo(0)}}if(n||this.eB&&!this.eB.d()){this.ss();_mgn.h.a()}}},ow:function(n,t){return this.fA().bD.DisplayName},ma:function(n,t){_lv.b.prototype.ma.call(this,n,t);this.sI()},fL:function(){_lv.h.prototype.fL.call(this);if(this.fe.a().m().Enabled&&this.eR){var i=this.eR;var n=i.bD.FolderId;if(i){var r=this;this.hv.a(function(t){t.r(i,n,r.fy())})}if(n&&n.a.Mailbox.EmailAddress){var t=_g.y.c(n.a.Mailbox.EmailAddress);if(this.kq()&&t.bD.SmtpAddress!==this.kq().bD.SmtpAddress){this.px(t);this.eW.a(_y.dz,new _y.dz(t))}}}this.sH()},ss:function(){this.fP=!1;this.iW=null;this.gO=null},ct:function(n,t){this.fP=!!n;this.iW=n;this.gO=t},oO:function(n){this.C()===1&&this.eB&&this.hh()>0&&this.dq(0)},sD:function(n){if(this.eR&&!this.eR.bD.IsDeepLinkedConversation)for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];if(this.eR===r){this.F(null);break}}},sE:function(){var t=this.eR;if(this.eR&&this.iT&&t.bD.IsDeepLinkedConversation){var n=this.eB.l(t.bD.ConversationId.Id);if(n){this.bo(1);this.bb(0);this.F(n);this.bb(1);this.bo(0)}}!this.eR&&this.eB.i()&&this.mx()},pw:function(n,t){this.eG("IsInSearchMode","IsCrossGroupSearch")},mY:function(n){return this.iV[_xc.d.a.toString(n)]},hK:function(n,t,i,r,u){r?Array.add(u,r):Array.add(u,new _fm.c(n,null,t));this.pt(i,u.length-1)},pt:function(n,t){this.iV[_xc.d.a.toString(n)]=t},sC:function(n){delete this.iV[_xc.d.a.toString(n)]},sy:function(){var t=this.gE.p;var u=t.x[this.mY(1)];var f=t.x[this.mY(2)];if(this.kp){if(this.eR){var r=this.eR.k();u.a(!r);f.a(r)}}else{u.a(!0);f.a(!0)}var n=t.x[this.mY(6)];if(this.hO&&this.hO.b()){if(!n){n=new _y.bE(_u.R.NR,null,this.ps,null,this.hO,_g.ba.a,!1,null,null,!1);t.a(n);n.a(!1);this.pt(6,t.x.length-1)}}else if(n){n.a(!0);var i=t.k(n);i>0&&t.n(i);this.sC(6);n=null}n&&n.bi()}};_xc.d.a=function(){};_xc.d.a.prototype={deleteContextMenuItemId:0,markReadContextMenuItemId:1,markUnreadContextMenuItemId:2,replyAllContextMenuItemId:3,forwardContextMenuItemId:4,firstSeperator:5,retentionPolicyContextMenuItemId:6};_xc.d.a.registerEnum("_xc.d.a",!1);_xc.c=function(n,t,i,r,u,f,e){this.bU=Function.createDelegate(this,this.dM);this.bT=Function.createDelegate(this,this.dL);this.bS=Function.createDelegate(this,this.dK);this.bR=Function.createDelegate(this,this.dJ);_xc.c.initializeBase(this,[n,i,r,u,e]);this.m.apcl("LastDeliveryTime",this.bR);this.m.apcl("RecentReplys",this.bS);this.m.b()&&this.m.b().apcl("LikeCount",this.bT);this.l&&this.l.fA()&&this.l.fA().unseenData&&this.l.fA().unseenData.apcl("LastVisitedTime",this.bU);this.t=new _y.dZ(r.a());t&&(n.Q=t.bD.SmtpAddress);this.bZ=f};_xc.c.b=function(n,t){return!n||!n.Mailbox||!n.Mailbox.EmailAddress||!t||!t.Mailbox||!t.Mailbox.EmailAddress?!1:n.Mailbox.EmailAddress.toLowerCase()===t.Mailbox.EmailAddress.toLowerCase()};_xc.c.prototype={t:null,bi:null,bx:null,bZ:!1,bw:function(){this.bi||this.cA(_xc.c.a.b(this.m,this.cy()).d());return this.bi},cA:function(n){if(this.bi!==n){this.bi=n;this.eC("UniqueSenders")}return n},L:function(){return this.m.y()&&this.m.y().b()>0?this.m.y().a(this.m.y().b()-1):this.m.b()},bY:function(){return this.L()?this.L().bD.Preview:this.m.bD.Preview},dw:function(){return this.L()===this.m.b()?!0:this.L()&&this.m.b()?_xc.c.b(this.L().bD.From,this.m.b().bD.From):!1},bV:function(){if(_g.U.isInstanceOfType(this.m.bD.FolderId)){var n=this.m.bD.FolderId;return n.a.Mailbox.Name}return null},cy:function(){this.bx||(this.bx=this.l.pu());return this.bx},cD:function(){return this.l.eK?this.cx():this.t.c(this.m)},cx:function(){return this.t.d(this.m)},cE:function(){return this.t.e(this.bV())},cF:function(){return _j.h.c(_mgs.X.CI,this.bV())},du:function(){return this.t.f(this.m)},dG:function(){return this.t.l(this.m)},dA:function(){return this.t.k(this.L(),this.m)},dx:function(){return this.t.g(this.m)},dy:function(){return this.t.h(this.m)},dz:function(){return this.t.i(this.m)},dE:function(){return!!this.p&&!this.p.a().Y().Enabled&&this.m.bD.MessageCount>1},dC:function(){return!!this.p&&this.p.a().dT().Enabled&&!!this.m&&!!this.m.b()&&this.m.b().co()>0},dD:function(){return!!this.p&&!this.p.a().Y().Enabled},cC:function(){if(this.m.b()&&this.m.b().bD.From)return this.m.b().bD.From;else if(this.bw()&&this.bw().length>0)return this.bw()[0].a;return null},bX:function(){if(this.m.b())return this.m.b();else if(this.m.f()&&this.m.f().b()>0&&this.m.f().a(0).toLocaleLowerCase().startsWith("ipm.schedule.meeting"))return new _dg.m;return null},bW:function(){return!this.l.eA(this.m)},dB:function(){return this.bZ?this.m.bD.UnreadCount>0:this.bW()},dF:function(){return this.l.gj()||this.l.hL()?!1:this.bW()},dv:function(){return!!this.p&&this.p.a().A().Enabled},cz:function(){return!!this.p&&this.p.a().cf().Enabled&&!this.p.a().Y().Enabled},eF:function(){this.m.rpcl("RecentReplys",this.bS);this.m.rpcl("LastDeliveryTime",this.bR);this.m.b()&&this.m.b().rpcl("LikeCount",this.bT);this.l&&this.l.fA()&&this.l.fA().unseenData&&this.l.fA().unseenData.rpcl("LastVisitedTime",this.bU);_lv.g.prototype.eF.call(this)},r:function(){if(this.cz()){this.bs(this.dI().i());this.bq(this.dH())}else _lv.d.prototype.r.call(this)},bO:function(n,t){this.eC("ShouldHighlightItem");_lv.g.prototype.bO.call(this,n,t)},dI:function(){var n=new _j.q;var t=3;n.d.length<t&&this.m.X()&&n.c(34);n.d.length<t&&this.m.b()&&this.m.b().co()>0&&n.c(33);n.d.length<t&&this.m.bD.HasAttachments&&n.c(2);n.d.length<t&&(this.m.be()==="Low"||this.m.be()==="High")&&n.c(1);return n},dH:function(){if(this.m.bD.MessageCount>1)return this.m.bD.HasIrm||this.m.bD.IsLocked?6:3;else if(this.m.bD.HasIrm||this.m.bD.IsLocked)return 5;else if(_dg.m.isInstanceOfType(this.bX()))return 13;else if(_dg.q.isInstanceOfType(this.bX()))return 17;return-1},dL:function(n,t){this.cz()?this.r():this.eC("ShowLikeCount")},dM:function(n,t){this.eG("HasUnseenMessages","ShowUnseenMarker")},dJ:function(n,t){this.eQ("ReceivedTimeAriaLabel","HasUnseenMessages","ShowUnseenMarker")},dK:function(n,t){this.cA(null);this.eJ(["MostRecentMessage","Preview","RepliesAriaLabel","IsRecentSenderSameAsInitialSender"])}};_xc.c.a=function(){this.c=new _j.q;this.b=new _j.q};_xc.c.a.c=function(){_xc.c.a.a||(_xc.c.a.a=new _rps.c);return _xc.c.a.a};_xc.c.a.b=function(n,t){var r=new _xc.c.a;if(n.b()){var f=_xc.c.a.c().c(n.b());r.a(n.b().bD.From,f)}n.y()&&n.y().n(function(n){var t=n;r.a(t.bD.From,null)});if(!r.b.d.length){var i;if(n.bD.SenderSMTPAddress){i=new _g.P;i.Mailbox=new _g.f;i.Mailbox.EmailAddress=n.bD.SenderSMTPAddress;n.g()&&n.g().b()>0&&(i.Mailbox.Name=n.g().a(0));r.a(i,null)}if(t){var u=n.bD.FolderId;i=new _g.P;i.Mailbox=u.a.Mailbox;r.a(i,null)}}return r};_xc.c.a.prototype={d:function(){return this.b.i()},a:function(n,t){if(n&&n.Mailbox&&(n.Mailbox.Name||n.Mailbox.EmailAddress)){var i=n.Mailbox.EmailAddress||n.Mailbox.Name;i=i.toLowerCase();if(!this.c.g(i)){this.b.c(new _xc.s(n,t));this.c.c(i)}}}};_xc.k=function(n,t,i,r){this.o=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.p);this.n=Function.createDelegate(this,this.u);_xc.k.initializeBase(this);this.a=null;this.h=n;this.c=t;this.i=new _j.g(this.n,_a.a.cf);this.g=new _j.g(this.m,_a.a.cf);this.j=i;this.l=r};_xc.k.prototype={a:null,i:null,g:null,h:null,j:null,l:null,c:null,f:null,e:null,b:0,d:null,v:function(n,t,i,r,u){this.a=n;if(this.a.b()>75){this.a.k(new _h.m(0,75),null,null);this.a.y(75)}this.f=t;this.e=i;this.d=r;this.b=u},s:function(){var t=0;this.b===3&&(t=1);if(this.a&&this.a.b()>=t){var n=this.a.b();return n<=20?n.toString():String.format(_mgs.X.Dn,20)}else return""},t:function(){return String.format(this.j,this.s())},r:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-ns-b")},q:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-nt-b")},u:function(){if(this.a){this.c&&this.c.a(this.o);this.h.a(_xs.f,new _xs.f(this.a))}},w:function(n){this.f&&this.d&&this.e&&this.a&&this.b&&n.bG(this.f,this.d,this.e,this.a.b(),_xt.b.toString(this.b))},p:function(){this.eC("IsClosed")}};_xc.j=function(n,t,i,r,u,f,e,o){this.u=Function.createDelegate(this,this.y);this.s=Function.createDelegate(this,this.x);this.v=Function.createDelegate(this,this.j);_xc.j.initializeBase(this,[11,"GroupFiles",n,r,t,i,new _y.bb(n.a(),null,new _xc.w,o,null,t),e]);this.a=u;this.o=o;this.p=f;if(this.a){this.a.w=new _j.g(this.v,_a.a.h);o.a().fw().Enabled&&this.a.bB(this.H);this.G.b(_y.bf,this.s)}this.j();this.h=new _y.y};_xc.j.prototype={p:null,a:null,o:null,b:null,h:null,z:function(n){this.b=n;this.eC("GroupFilesModuleContentViewModel");return n},O:function(){if(this.N){this.i&&this.a&&this.a.g.b(this.i);var n=this;this.r(function(t){t.b(n.i)});this.m().c(this.i)}},S:function(){_y.eK.prototype.S.call(this);if(this.N){if(this.a&&this.a.g&&this.a.g.a()!==this.i)this.j();else if(this.i){var n=this;this.r(function(t){t.b(n.i)})}this.m().c(this.i)}else{this.m().d();this.b&&this.b.d()}this.N&&this.a&&this.a.v()},j:function(){this.a&&this.a.g&&this.a.g.a()&&this.g(this.a.g.a())},r:function(n){if(this.b)n&&n(this.b);else{var t=this;this.p.b(function(i){if(!t.b){t.z(i);t.h.c(t.b);t.m().a()&&t.m().a().b()&&t.b.a(t.m().a().a());t.o.a().fw().Enabled&&t.b.e(t.H);t.m().a().apcl("IsModelLoaded",t.u)}n&&n(t.b)})}},y:function(n,t){this.b.a(this.m().a().a())},x:function(n){if(n.b===11){this.a.g.d(n.a);if(this.i)if(this.i.a()!==n.a)this.j();else{var t=this;this.r(function(n){n.c()})}n.g(this)}}};_xc.w=function(){_xc.w.initializeBase(this,[null,null])};_xc.w.prototype={iS:function(){return!0}};_xc.g=function(n,t,i){this.b=n;this.d=t;this.c=i};_xc.g.prototype={d:null,b:null,c:null,a:function(n){var f=n.c;var h=new _xc.m(_g.y.f(f).bD.FolderId,null,_xc.g.a,!0,"GroupConversationFeedView",f);var u;var r=this.c;var o,s;var t=(s=_h.c.v(h,this.b,this.d,r.a||(r.a=Function.createDelegate(r,r.b)),o={val:u}),u=o.val,s);if(u){n.f=4;return}var i=_a.c.b(_a.a.cK,"GroupConversationPrefetch");i.l=f.bD.SmtpAddress;n.f=1;var e=null;var c=this;e=function(){if(!t.d()||t.v()){t.bn(e);if(t.x())i.m="LoadingFailed";else{n.l&&i.p(_xc.g.b);n.f=2}_a.c.a(i)}};t.bc(e);t.k(new _h.m(0,15),702,null)}};_xc.o=function(n,t,i,r){this.fM=Function.createDelegate(this,this.he);this.de=_a.I.a();_xc.o.initializeBase(this,[n,t,i,r]);this.ea=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fM,3e4);this.dZ=t};_xc.o.prototype={ea:null,cE:0,dZ:null,bl:function(){_xc.b.l();_xc.h.prototype.bl.call(this)},fN:function(n,t,i){var r="Group_Conversation_QuickComposeReply_Delivery";this.ea.a();if(!n.t){n.t=!0;this.cE++;n.v=_a.c.b(_a.a.w,r,!1);n.v.p(t?_xc.b.k:_xc.b.h);n.v.p(i?_xc.b.j:_xc.b.i)}},fQ:function(n){if(n.t){n.t=!1;this.hc();if(n.v){_xc.b.D(n.v,_xc.b.a(n.b(),!1,!1),n.Q);n.v=null}}},he:function(){var n=this;this.de.d(function(n,t){_xc.b.c(2,n,!1,null)});this.fO()},fO:function(){this.cE>0&&this.eg(!0);this.fP(!this.df())},hc:function(){this.cE--;this.cE<=0&&this.fP(!0)},fP:function(n){this.ea.b();n&&(this.de=_a.I.a());this.cE=0},ec:function(n){if(!this.hf(n)){_xc.h.prototype.ec.call(this,n);this.df()&&this.cE>0&&this.fO()}},eh:function(n,t,i,r){if(n){if(!n.Conversation){t||_j.e.c(this.bC(),"Conversation can't be null for new posts");var f=this.l(n.ConversationId.Id);f&&(n.Conversation=f.bD)}n.Conversation&&t&&r&&(n.Conversation.LastDeliveryTime=n.DateTimeReceived)}if(r)return _xc.h.prototype.eh.call(this,n,t,i,r);var u=_xc.h.prototype.eh.call(this,n,t,i,r);if(u){this.de.a(n.InternetMessageId,new _xc.o.a(n.Conversation.ConversationId.Id));t||this.hb(n)}return u},hb:function(n){var t=_ff.e.a(n,!0);var u=new _bc.f;t.ItemId=u.b;t.InstanceKey="INSK:"+u.a;var r=this.dZ.a(200,n.Conversation.ConversationId);var i=r.m(t,null);i.m(!0);i.g(new _a.k(n.ToRecipients));_h.c.u(n.Conversation.ConversationId,this.e(),r)},hf:function(n){if(this.df())return!1;if(this.cE>0)if(n.EventType==="RowAdded"){var i=this.da(n.Conversation.ConversationId.Id);if(i>=0&&i<this.by.x.length){var r=this.by.x[i];if(r.t){var u=this.cV;this.bR(!0);try{this.fQ(r);this.by.y(i,4);this.bs(n,!0)}finally{this.bR(u)}this.fR(r);return!0}}}else if(n.EventType==="RowModified"){var t=this.l(n.Conversation.ConversationId.Id);if(t.t&&t.bD.MessageCount<=n.Conversation.MessageCount){this.bu(n);this.fR(t);this.fQ(t);return!0}}return!1},eR:function(n,t,i){var r=_xc.h.prototype.eR.call(this,n,t,i);if(i)return r;r&&this.fN(r,!1,t);return r},eS:function(n,t,i){var r=_xc.h.prototype.eS.call(this,n,t,i);if(i)return r;r&&this.fN(r,!0,t);return r},bN:function(n,t){var i=this;this.de.d(function(n,t){var r=i.l(t.a);if(r){var u=_h.d.a().a(r.bD.ConversationId.Id);u&&u.s()!==""||_h.c.m(r.bD.ConversationId,n);r.t=!1}_xc.b.c(3,n,!1,null)});this.de=_a.I.a();_h.r.prototype.bN.call(this,n,t)},bx:function(){_xc.b.l();_xc.h.prototype.bx.call(this)},cu:function(n){_lm.d.prototype.cu.call(this,n);var t=n.G.ErrorCode;var i=n.G.ExceptionName;_j.B.a(t)||t!==500||i!=="AccessDeniedException"||(this.cn="ErrorAccessDenied")},fR:function(n){var t=this;_h.c.o(203,n,n.bD.FolderId,function(n){var r=n.r();if(r)for(var i=r,f=i.length,t=0;t<f;++t){var u=i[t];_xc.b.c(0,u,!1,null)}},this.dZ)}};_xc.o.a=function(n){this.a=n};_xc.o.a.prototype={a:null};_xc.h=function(n,t,i,r){this.fS=Function.createDelegate(this,this.hv);this.cR={};this.dh=new _j.q;_xc.h.initializeBase(this,[n,t,r]);this.ef=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fS,1e4)};_xc.h.prototype={ee:!1,dg:!1,ed:!1,cF:0,ef:null,eb:null,H:function(){return this.bY.a().bo().Enabled},df:function(){return this.ee},eg:function(n){if(this.ee!==n){this.ee=n;this.bw("NeedsRefresh")}return n},bC:function(){return _a.a.cK},v:function(){return _h.r.prototype.v.call(this)&&this.by.x.length>0},cL:function(){return this.bB.f?15:_lm.d.prototype.cL.call(this)},db:function(){return this.bB.f?2e3:_lm.d.prototype.db.call(this)},fT:function(){return!!this.bB.k},ec:function(n){this.dg?this.hm(n):this.bY.a().bo().Enabled&&this.hl(n)},hl:function(n){if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var i=this.cC(n);this.cR[i]=!0;if(this.cF>0){this.fU(n);return}var r=_ff.o.a(0,6e4);var t=this;_j.m.a().a(this.bC(),"GroupConversationItemQueryTable::HandleRowNotificationWhenOnBackground",function(){t.bK||t.dg||t.bm()},r)}},hm:function(n){if(this.hj()&&n.EventType==="Reload"){_j.e.a(this.bC(),"HandleRowNotification: If we reach this point, it means that a thread was deleted and we need to refresh the entire table.");this.eg(!0);return}if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var t=this.cC(n);this.cR[t]=!0;if(!this.df()){if(this.cF>0){this.fU(n);return}if(n.EventType==="RowAdded"){if(t in this.ca)return;if(this.hw(n))return}if(n.EventType!=="RowDeleted"||t in this.ca){if(n.EventType==="RowModified")if(t in this.ca){var i=this.cB(t);if(i>=0&&i<this.by.x.length){var f=this.by.x[i];if(f.bD.MessageCount>=n.Conversation.MessageCount)return}}else if(this.by.x.length>0){var u=this.by.x[this.by.x.length-1];var r=_a.d.b(n.Conversation.LastDeliveryTime);if(r.b(u.h())<0)return}_j.e.a(this.bC(),"HandleRowNotification: Table needs refresh.");this.eg(!0)}}}},hs:function(){if(!this.eP()){_j.e.a(this.bC(),"OnPostStarted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.bB.f&&this.ho()},eP:function(){return!this.bK&&!this.fT()&&this.dg},bv:function(n,t){if(!this.eP()){_j.e.a(this.bC(),"OnMessageLike:: Table is not updatable. Key:{0}.",this.bB.a());return}if(n&&n.Conversation){var i=n.Conversation.InstanceKey;if(!(i in this.ca)){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",i);return}var u=this.cB(i);if(u<0||u>=this.by.x.length){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in table, ignore it. InstanceKey: {0}.",i);return}var r=this.by.x[u];if(t){var e;(e=r.b()).cG(e.co()-1)}else{var f;(f=r.b()).cG(f.co()+1)}this.bQ(r,n.Conversation);this.cR[i]=!0}},hr:function(n,t,i,r){if(!this.eP()){_j.e.a(this.bC(),"OnPostCompleted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.eh(n,t,i,r);this.bB.f&&this.hh()},bl:function(){this.dg=!1;if(this.bB.f){this.d()&&!this.v()||this.bU||this.df()||this.hx();_h.r.prototype.bl.call(this)}},bk:function(){this.dg=!0;_h.r.prototype.bk.call(this)},M:function(n,t,i,r){this.eb=n;this.k(t,i,r);this.eb=null},cH:function(n){if(_g.U.isInstanceOfType(this.e())&&this.hi()){n.a().MailboxId=this.e().Id;return new _h.H(n.a())}else return _lm.b.prototype.cH.call(this,n)},bx:function(){this.fV();_lm.b.prototype.bx.call(this)},dB:function(n,t,i){n.a||this.fV();_lm.d.prototype.dB.call(this,n,t,i)},dK:function(n,t,i,r){var u=new _xc.i(this.e(),this.r(),n,t,this.bS(),this.bF(),r,i,this.bB.h,this.eb);u.s=this.cv;return u},bX:function(n,t,i,r,u,f){r&&_lm.b.prototype.bX.call(this,n,t,i,r,u,f)},cG:function(n){},cK:function(n,t,i,r){this.ed=this.bB.f&&this.hp(n);return this.ed?this.hg(t,i,r):_lm.b.prototype.cK.call(this,n,t,i,r)},eJ:function(n,t){this.ed?this.hu(n,t):_lm.d.prototype.eJ.call(this,n,t)},hp:function(n){return n in this.cR},hw:function(n){var t=this.da(n.Conversation.ConversationId.Id);if(t>=0&&t<this.by.x.length){var u=this.by.x[t];var f=u.bD.InstanceKey;var i=this.ca[f];if(i){this.ca[f]=null;var r=n.Conversation.InstanceKey;u.bm(r);this.ca[r]=i;return!0}}return!1},hg:function(n,t,i){var r=new _gg.eB;r.Item=new _g.d("ConversationLastDeliveryTime");r.FieldURIOrConstant=new _g.S;var f=new _g.R;f.Value=_a.d.b(t).l(1).i();r.FieldURIOrConstant.Item=f;var e=new _g.bb(r);var u=new _g.bd("Beginning",e);u.MaxEntriesReturned=n-1;this.r()&&(this.r().f=this.bV);return this.dK(u,!1,t,i)},hu:function(n,t){for(var i=0;i<n.length;i++){var r=t.d(n[i]);if(!(r in this.ca))break;Array.removeAt(n,i);i--}},fV:function(){this.cR={};this.eg(!1);this.dh.f();this.eQ()},eh:function(n,t,i,r){if(this.bK){_j.e.a(this.bC(),"OnPostCompleted:: Table already disposed, ignore call. Key:{0}.",this.bB.a());return!1}if(this.fT()){_j.e.a(this.bC(),"OnPostCompleted:: Table in Search View, ignore call. Key:{0}.",this.bB.a());return!1}if(n&&n.Conversation){var u=null;u=t?this.eS(n.Conversation,i,r):this.eR(n.Conversation,i,r);return!!u}return!1},ht:function(){for(var n=0;n<this.dh.d.length;n++){var t=this.dh.d[n];this.ec(t)}this.dh.f()},fU:function(n){this.dh.c(n)},eR:function(n,t,i){var u=n.InstanceKey;if(u in this.ca){_j.e.a(this.bC(),"UpdateTableWithQuickComposeReponse: Conversation already in table, ignore it. InstanceKey {0}.",u);return null}var r=this.bG(n);this.by.B(0,r,4);this.y(this.bE+1);return r},eS:function(n,t,i){var u=n.InstanceKey;if(!(u in this.ca)){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",u);return null}var f=this.cB(u);if(f<0||f>=this.by.x.length){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in table, ignore it. InstanceKey: {0}.",u);return null}var r=this.by.x[f];var e=r.h();this.bQ(r,n);if(i){r.bo(_a.d.b(n.LastDeliveryTime));this.by.C(f,0,r,4)}else r.bo(e);r.Z(r.bD.MessageCount+1);r.o(r.bD.UnreadCount+1);r.x(r.bD.GlobalMessageCount+1);r.U(r.bD.GlobalUnreadCount+1);this.cR[u]=!0;return r},hv:function(){if(this.bK){_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Table already disposed, ignore call. Table Key:{0}.",this.bB.a());return}_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Reset count and process pending notifications for table Key:{0}.",this.bB.a());this.eQ()},ho:function(){this.cF++;this.ef.a()},hh:function(){if(!(this.cF<=0)){if(this.cF===1){this.eQ();return}this.cF--}},eQ:function(){this.cF=0;this.ef.b();this.ht()},hx:function(){var n=this.bB.g;if(n&&n.isMember&&!_mgn.e.a().a(n.a())){this.ey.a(_mgn.d,new _mgn.d(n.bD.SmtpAddress,n.bD.DisplayName,4));n.j=n.unseenData.a();var t;t=new _xh.J(n.bD.SmtpAddress,_a.d.get_utcNow(),this.bY);_a.g.a.a(t)}},hj:function(){return!!this.bY&&this.bY.a().je().Enabled},hi:function(){return!!this.bY&&this.bY.a().hz().Enabled},hk:function(){return!!this.bY&&this.bY.a().bw().Enabled},ce:function(n,t,i,r,u,f){var s=t.L===700;var h=t.bs;if(this.hk()&&!s&&!h){for(var e=0;e<n.length;e++){var o=this.bG(n[e]);if(this.hn(o))break}if(e&&e!==n.length)while(n.length>e)Array.removeAt(n,e)}_h.r.prototype.ce.call(this,n,t,i,r,u,f)},hn:function(n){var t=this.bB.g;return n.h().p().b(t.o().p())<=0},k:function(n,t,i){if(t===700||t===200){this.hq(n,t,i);return}_lm.d.prototype.k.call(this,n,t,i)},hq:function(n,t,i){var r=n;r.b>this.db()&&(r.b=this.db());this.dB(r,t,i)}};_xc.m=function(n,t,i,r,u,f){_xc.m.initializeBase(this,[n,t,"All",i,null,null,-1]);this.f=r;this.h=u;this.g=f};_xc.m.prototype={f:!1,h:null,g:null,e:function(){var n=null;if(this.k)n=[new _h.dE(this)];else{var t=new _xc.p(this,!0,this.x(),this.m,this.h);n=[t]}return n}};_xc.b=function(){};_xc.b.B=function(n,t,i,r,u,f){if(_j.h.a(n)){_j.e.c(_a.a.w,"Internet message id can't be null");return null}var o=_xc.b.d+"_"+n;var e=_a.n.b(_a.a.w,_xc.b.d,!0,null,o);if(e){_xc.b.g.c(n);e.p(t?_xc.b.k:_xc.b.h);e.p(i?_xc.b.j:_xc.b.i);r&&e.p(_xc.b.x);u&&e.p(_xc.b.A);f&&e.p(_xc.b.m)}return e};_xc.b.f=function(n,t,i){if(_j.h.a(n)){_j.e.c(_a.a.w,"Internet message id can't be null");return}var f=_xc.b.d+"_"+n;var r=_a.n.c(f);if(r){r.n=t;if(!_j.h.a(i)){var u=new _a.l;u.b(_xc.b.w,i);r.l=u.toString()}}};_xc.b.c=function(n,t,i,r){var f=_xc.b.d+"_"+t;var u=_a.n.c(f);if(u){i&&u.p(_xc.b.C);switch(n){case 0:u.m=null;break;case 1:u.m=r;break;case 2:u.m=_xc.b.y;break;case 3:u.m=_xc.b.z;break;case 4:u.m=_a.c.e;break;default:throw Error.argument("endScenario","Unsupported PostCtqEndScenario type.");}_xc.b.g.n(t);_a.n.a(f)}};_xc.b.l=function(){for(var t=_xc.b.g.i(),n=0;n<t.length;n++)_xc.b.c(4,t[n],!1,null)};_xc.b.e=function(n,t){return _a.n.b(n,t,!0)};_xc.b.D=function(n,t,i){n.l=t;n.s=i;_a.c.a(n)};_xc.b.b=function(n,t,i,r,u){var f=_a.n.c(n);if(f){f.m=t;f.n=i;f.l=r;f.s=u;_a.n.a(n)}};_xc.b.a=function(n,t,i){var c=_xc.b.n;if(n){var h=-1;var o=-1;n.O()&&n.O().bD.Value&&(h=n.O().bD.Value.length);n.bD.Subject&&(o=n.bD.Subject.length);var f=-1;var l=-1;if(n.bf()&&n.bf().b()>=0){var s=0;f=n.bf().b();for(var e=0;e<f;e++)s+=n.bf().a(e).b();l=s/1024>>0}var u=-1;if(n.n()||n.q()||n.z()){u=0;n.n()&&(u+=n.n().b());n.q()&&(u+=n.q().b());n.z()&&(u+=n.z().b())}var r=new _a.l;r.a(_xc.b.r,h);r.a(_xc.b.v,o);r.a(_xc.b.o,100);r.a(_xc.b.p,f);r.a(_xc.b.q,l);r.a(_xc.b.s,u);r.c(_xc.b.t,t);r.c(_xc.b.u,i);c=r.toString()}return c};_xc.p=function(n,t,i,r,u){_xc.p.initializeBase(this,[n,t,i,r,null,-1,u,null,null])};_xc.p.prototype={e:function(){return"GroupRowNotificationStrategy"},f:function(n,t){if(t.bK){_j.e.a(t.bC(),"Abandoning row notification due to associated table [{0}] being disposed.",t.bB.a());return}var i=t;i.bB.f?i.ec(n):_h.w.prototype.f.call(this,n,t)}};_xc.e=function(n,t,i){this.f=n;this.b=t;this.a=i};_xc.e.b=function(n){var o=null;if(!_j.h.a(n)){var t;n=n.replace(_xc.e.d,"");var f,e;if((e=_a.z.a(n,f={val:t}),t=f.val,e)&&!_j.h.a(t)){var i=t.split("\n");var u=_xc.e.f(i);if(u<i.length){var r=i[u].trim();o=r.length<=100?r:r.substring(0,100)}}}return o};_xc.e.a=function(n,t,i,r,u){_xc.e.e(function(i){i.hr(n,t,r,u)},i)};_xc.e.c=function(n){_xc.e.e(function(n){n.hs()},n)};_xc.e.e=function(n,t){var u=_h.g.a().a(t);if(u)for(var f=u,e=f.length,i=0;i<e;++i){var r=f[i];_xc.h.isInstanceOfType(r)&&n(r)}};_xc.e.f=function(n){for(var t=0;t<n.length;){if(n[t].trim().length)break;t++}return t};_xc.e.prototype={f:null,a:null,b:!1,c:function(n){var t=new _g.L;t.Subject=this.b&&!_j.h.b(n.bD.Subject)?n.bD.Subject:_xc.e.b(n.O().bD.Value);t.Body=new _g.s("HTML",n.O().bD.Value);t.ToRecipients=_db.e.a(n.n());t.From=n.bD.From;if(this.a){this.a.d()&&(t.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cu()&&(t.MentionsEx=_mco.g.a(n.cu(),n.bD.From));this.a.e()&&n.cC()&&(t.Hashtags=n.cC().e())}!n.bD.ItemId&&n.bD.InternetMessageId&&(t.InternetMessageId=n.bD.InternetMessageId);t.ItemId=n.bD.ItemId;_db.e.b(n,t);return t},d:function(n,t,i,r){var u=new _g.bs;u.Subject=t.bD.Subject;u.NewBodyContent=new _g.s("HTML",n.O().a()==="HTML"?n.O().bD.Value:_a.z.b(n.O().bD.Value,!0,!0));var e=0;var f=0;if(n.n()){u.ToRecipients=n.n().e();e=n.n().b()}if(n.q()){u.CcRecipients=n.q().e();f=n.q().b()}u.From=n.bD.From;if(this.a){this.a.d()&&(u.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cu()&&(u.MentionsEx=_mco.g.a(n.cu(),n.bD.From));this.a.e()&&n.cC()&&(u.Hashtags=n.cC().e())}n.bD.InternetMessageId&&(u.InternetMessageId=n.bD.InternetMessageId);i&&(u.UpdateResponseItemId=i);u.ReferenceItemId=_g.e.a(t.bD.ItemId);u.IsSpecificMessageReply=r;_db.e.b(n,u);return u},e:function(n){if(!n||!n.f())return null;for(var t=0;t<n.f().b();t++){var i=n.f().a(t);if(i.toLocaleLowerCase().startsWith("ipm.note.connectormessage"))return i}return null}};_xc.f=function(n,t,i,r,u,f,e,o,s){_xc.f.initializeBase(this);this.f=n;this.e=r;this.s=_xc.f.b(r,u);this.p=_xc.f.a;this.j=e;this.k=new _xc.e(f,s,o);this.F=t;this.u=i};_xc.f.b=function(n,t){var i=_ff.e.a(_h.b.d());i.ConversationShapeName=t;i.ConversationFolderId=_g.m.c(n);return i};_xc.f.c=function(n,t,i){var r=null;if(n.Items&&n.Items.length>0){r=n.Items[0];if(t.a()==="HTML")r.UniqueBody=new _g.s("HTML",t.bD.Value);else throw Error.notImplemented("Plaintext body is not currently supported in quick compose.");}return r};_xc.f.prototype={e:null,s:null,p:"Folder",f:null,F:0,u:0,k:null,bk:null,j:!1,r:function(){return"QuickCompose"},o:function(n){n.h(this.e.a.Mailbox.EmailAddress,this.e.b)},K:function(n){this.bu();if(this.j){var r=this.bs();var i=this.br();n.cH(r,i,this.J,this.H)}else{var u=this.bt();var t=this.bp();t.explicitLogonUser=this.e.a.Mailbox.EmailAddress;n.cI(u,t,this.J,this.H)}},cI:function(n){_j.e.a(_a.a.B,"PostModernGroupItemAction.ProcessResponseMessage called");var t=_xc.f.c(n,this.f.O(),this.e);t&&(this.bk=t.ItemId);this.t(t);this.bm()},bb:function(n){_h.ft.prototype.bb.call(this,n);this.t(null);this.bl()},bm:function(){var n=this.O();this.bo(n);_xc.b.b("Group_Conversation_QuickCompose",null,n,_xc.b.a(this.f,!1,!1),this.e.a.Mailbox.EmailAddress)},bl:function(){var t=this.O();var n=this.P();this.bn(t,n);_xc.b.b("Group_Conversation_QuickCompose",n,t,_xc.b.a(this.f,!1,!1),this.e.a.Mailbox.EmailAddress)},t:function(n){_xc.e.a(n,!1,this.e,!1,!1)},bo:function(n){this.j&&_xc.b.f(this.f.bD.InternetMessageId,n,null)},bn:function(n,t){if(this.j){_xc.b.f(this.f.bD.InternetMessageId,n,null);_xc.b.c(1,this.f.bD.InternetMessageId,!1,t)}},bt:function(){var t=new _gg.eQ;this.bh(t);var n=new _gg.jk(this.M());n.Body=t;return n},bs:function(){var t=new _gg.eP;this.bh(t);var n=new _gg.jj(this.M());n.Body=t;return n},bi:function(){return[this.k.c(this.f)]},bh:function(n){n.ModernGroupEmailAddress=this.e.a.Mailbox;n.Items=this.bi();n.ShapeName=this.p;n.ItemShape=this.s;n.ClientSupportsIrm=!0;n.UnpromotedInlineImageCount=this.F;n.PromoteEmojiContentToInlineAttachmentsCount=this.u},bp:function(){var n=new _gg.yp(this.L);n.actionName=this.r();return n},br:function(){var n=new _gg.yo(this.L);n.actionName=this.r();return n},bu:function(){_xc.e.c(this.e)}};_xc.q=function(n,t,i){this.e=n;this.d=t;this.f=i};_xc.q.prototype={e:null,d:null,f:0,c:null,b:function(){if(this.c){_j.m.a().b(this.c);this.c=null}},a:function(){this.b();this.c=_j.m.a().a(_a.a.dv,this.e,this.d,this.f)}};_xc.r=function(){};_xc.r.prototype={a:function(n,t,i){return new _xc.q(n,t,i)}};_xc.s=function(n,t){this.a=n;this.b=t};_xc.s.prototype={a:null,b:null,c:function(){return!!this.b}};_xc.a=function(){};_xc.a.$$cctor=function(){_xc.a._I()};_xc.a.w=function(){var n=window.document.createElement("DIV");n.innerHTML="<div>  <span class='_xc_3 _xc_4 ms-font-l ms-font-color-themePrimary'></span> <span class='_xc_6'></span> </div><div> <span class='_xc_2 ms-font-color-neutralSecondary ms-font-color-neutralPrimary ms-font-weight-semilight'></span> <button type='button' class='_xc_5 ms-font-weight-regular'></button> </div><div> <span class='_xc_7 ms-font-weight-semilight ms-font-color-neutralPrimary ms-font-m'></span> <span class='_xc_7 ms-font-weight-semilight ms-font-color-themePrimary ms-font-m'></span> </div><div> <div CssClass=\"suggestionDiv\"> <button type='button'></button> </div> <button type='button' class='_xc_9'></button> </div><div> <div> </div> </div><div> <div></div> </div><div>  <div class='_xc_b'> <div></div> </div>  <div class='_xc_d'></div> </div><div> <div class='_xc_a'> <div class='_xc_c'> <div></div> </div> </div> </div><div> <div class='_xc_e _xc_f'>  <div> <div></div> </div> <div></div> <div> </div> </div> </div>";_j.i.a().appendChild(n);return n};_xc.a.d=function(n){return n.m()};_xc.a.i=function(n){return n.c()};_xc.a.M=function(n){return n.w()};_xc.a.q=function(n){return n.b()};_xc.a.F=function(n){return n.q()};_xc.a.B=function(n){return n.k()};_xc.a.bk=function(n){return n.t()};_xc.a.bl=function(n){return n.l};_xc.a.bj=function(n){return n.i};_xc.a.bh=function(n){return n.g};_xc.a.bi=function(n){return n.r()};_xc.a.u=function(n){return n.q()};_xc.a.c=function(n){return n.a};_xc.a.r=function(n){return n.a};_xc.a.K=function(n){return n.H};_xc.a.N=function(n){return n.b};_xc.a.V=function(n){return n.c};_xc.a.J=function(n){return n.f};_xc.a.U=function(n){return n.e};_xc.a.t=function(n){return n.g};_xc.a.P=function(n){return n.c};_xc.a.s=function(n){return n.d};_xc.a.S=function(n){return n.d};_xc.a.j=function(n){return n.a};_xc.a.R=function(n){return n.h()};_xc.a.Q=function(n){return n.g};_xc.a.bg=function(n){return n.m()};_xc.a.bf=function(n){return _xh.c.isInstanceOfType(n)?n.bm():null};_xc.a.be=function(n){return n.h};_xc.a.p=function(n){return n.b()};_xc.a.g=function(n,t){n.a(t)};_xc.a.E=function(n,t){n.a(t)};_xc.a.n=function(n,t){n.K(t)};_xc.a.o=function(n,t){n.bl(t)};_xc.a.A=function(n,t){n.j(t)};_xc.a.m=function(n,t){n.l(t)};_xc.a.x=function(n,t){n.Q(t)};_xc.a.D=function(n,t){n.c(t)};_xc.a.G=function(n,t){n.m(t)};_xc.a.C=function(n,t){n.j(t)};_xc.a.l=function(n,t){n.T(t)};_xc.a.y=function(n,t){n.m(t)};_xc.a.z=function(n,t){n.s(t)};_xc.a.W=function(n,t){n.f(t)};_xc.a.O=function(n,t){n.b=t};_xc.a.Y=function(n,t){n.g(t)};_xc.a.L=function(n,t){n.bj(t)};_xc.a.X=function(n,t){n.o(t)};_xc.a.h=function(n,t){n.ba(t)};_xc.a.bb=function(n,t){n.e(t)};_xc.a.T=function(n,t){n.F(t)};_xc.a.bd=function(n,t){n.l(t)};_xc.a.bc=function(n,t){n.b(t)};_xc.a.I=function(n,t){n.j(t)};_xc.a.H=function(n,t){n.bU(t)};_xc.a.ba=function(n,t){n.b(t)};_xc.a.Z=function(n,t){n.c(t)};_xc.a.k=function(){_xc.a.e||(_xc.a.e=new _fc.j);return _xc.a.e};_xc.a.v=function(){_xc.a.f||(_xc.a.f=new _fc.l);return _xc.a.f};_xc.a._I=function(){var e="GroupSearchResultsHeader._tid1";new _j.d(e,function(){_xc.a.a[e]===undefined&&(_xc.a.a[e]=[[[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,4,null,null,null,"Id",null,_xc.a.E,0,null,null,null,_n.b.cn()]]]);var n=_xc.a.b.childNodes[0].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_xs.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var f="GroupSearchResultsHeader";new _j.d(f,function(){_xc.a.a[f]===undefined&&(_xc.a.a[f]=[[[-1,4,null,null,null,"Text",null,_xc.a.g,0,null,null,null,_mgs.X.Co]],[[-1,4,null,null,null,"ImageId",null,_xc.a.m,0,null,null,null,_n.b.cn()],[-1,0,["ShouldShowSortByMenuOnHeader"],[_xc.a.M],null,"IsHidden",null,_xc.a.n,1,_xc.a.k(),null,!0],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Title",null,_xc.a.o,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.A,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"AriaLabel",null,_xc.a.x,1,null,null,null]]]);var i=_xc.a.b.childNodes[1].cloneNode(!0);var t=new _fc.b(i.children[1]);var n=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu"],[_xc.a.d,_xc.a.q],null,"MenuDataContext",null,_xc.a.D,1)).U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu","IsShown"],[_xc.a.d,_xc.a.q,_xc.a.F],_xc.a.G,"IsShown",_xc.a.B,_xc.a.C,2,null,null,!1));n.b=1;n.a=3;n.g="headerMenuDropShadow ms-border-color-themeLight";t.C([n]);t.y("GroupSearchResultsHeader._tid1");var r=new _fc.a(i.children[0]);return new _j.a(i,[r,t])},"",_xs.c,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var s="SuggestGroupsSearchView._tid2";new _j.d(s,function(){_xc.a.a[s]===undefined&&(_xc.a.a[s]=[[[-1,0,["SuggestGroupSearchPrefechedResultsText"],[_xc.a.bk],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,0,["SuggestGroupSearchSeeResultsText"],[_xc.a.bl],null,"Text",null,_xc.a.g,1,null,null,null]]]);var n=_xc.a.b.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_xc.k,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var o="SuggestGroupsSearchView";new _j.d(o,function(){_xc.a.a[o]===undefined&&(_xc.a.a[o]=[[[-1,0,["GoToSuggestedGroupSearchCommand"],[_xc.a.bj],null,"ClickCommand",null,_xc.a.l,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_xc.a.o,0,null,null,null,_u.R.Pr],[-1,0,["CloseCommand"],[_xc.a.bh],null,"ClickCommand",null,_xc.a.l,1,null,null,null],[-1,0,["CloseImage"],[_xc.a.bi],null,"ImageId",null,_xc.a.m,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"HoveredImageId",null,_xc.a.y,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"PressedImageId",null,_xc.a.z,0,null,null,null]]]);var n=_xc.a.b.childNodes[3].cloneNode(!0);var i=new _fc.b(n.children[1]);var t=new _fc.b(_j.a.a(n,[0,0]));t.y("SuggestGroupsSearchView._tid2");return new _j.a(n,[t,i])},"",_xc.k,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var u="FilesModernNavigationPaneView._tid3._tid4";new _j.d(u,function(){_xc.a.a[u]===undefined&&(_xc.a.a[u]=[[[-1,0,["MailNavigationViewModel","FolderForest","FirstLevelNavigationFolderTrees"],[_xc.a.c,_xc.a.r,_xc.a.K],null,"DataSource",null,_xc.a.W,1,null,null,null],[-1,0,["FirstLevelNavigationSelectedTree"],[_xc.a.N],_xc.a.O,"SelectedTreeData",_xc.a.V,_xc.a.Y,2,null,null,null],[-1,0,["MailNavigationViewModel","FolderForest","ActionTargetFolder"],[_xc.a.c,_xc.a.r,_xc.a.J],_xc.a.L,"DropTargetTreeNodeData",_xc.a.U,_xc.a.X,2,null,null,null]]]);var t=_xc.a.b.childNodes[4].cloneNode(!0);var n=new _n.C(t.children[0],_j.b.Instance.a(_n.d));return new _j.a(t,[n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var t="FilesModernNavigationPaneView._tid3._tid5";new _j.d(t,function(){_xc.a.a[t]===undefined&&(_xc.a.a[t]=[[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"DataContext",null,_xc.a.h,1,null,null,null]]]);var i=_xc.a.b.childNodes[5].cloneNode(!0);var n=new _j.c(i.children[0]);n.y("CondensedGroupsNavigationView");return new _j.a(i,[n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var n="FilesModernNavigationPaneView._tid3";new _j.d(n,function(){_xc.a.a[n]===undefined&&(_xc.a.a[n]=[[[-1,5,["MailNavigationViewModel","IsExpanded"],[_xc.a.c,_xc.a.P],null,"hidden",null,null,0,_xc.a.k(),null,null]],[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"IsHidden",null,_xc.a.n,1,_xc.a.v(),null,!0]]]);var r=_xc.a.b.childNodes[6].cloneNode(!0);var i=new _j.c(r.children[1]);i.y("FilesModernNavigationPaneView._tid3._tid5");var t=new _j.c(_j.a.a(r,[0,0]));t.y("FilesModernNavigationPaneView._tid3._tid4");return new _j.a(r,[t,i]).l({FoldersControl:t,GroupsControl:i})},"",_y.s,_n.G,function(n){return new _n.G(n)},!1,!0,!1,0,_xc.a.a);var r="FilesModernNavigationPaneView";new _j.d(r,function(){_xc.a.a[r]===undefined&&(_xc.a.a[r]=[null,null,[[-1,0,["MailNavigationViewModel","Width"],[_xc.a.c,_xc.a.s],null,"LeftNavWidth",null,_xc.a.bb,1,null,null,0],[-1,2,["MailNavigationViewModel","WidthOfScrollRegion"],[_xc.a.c,_xc.a.S],null,_fce.c.b,null,null,1,null,null,null]]]);var t=_xc.a.b.childNodes[7].cloneNode(!0);var n=new _n.G(_j.a.a(t,[0,0,0]));n.eD(_fce.c.a,3);n.L(!0);n.y("FilesModernNavigationPaneView._tid3");n.z.parentNode.removeChild(n.z);var i=new _fce.c(_j.a.a(t,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.b(1);var u=new _fce.f(t.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));u.L(!0);i.a.a(n);return new _j.a(t,[u,i,n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a);var i="GroupFilesModuleView";new _j.d(i,function(){_xc.a.a[i]===undefined&&(_xc.a.a[i]=[null,[[-1,2,["MailModernNavigationPane","MailNavigationViewModel","Width"],[_xc.a.j,_xc.a.c,_xc.a.s],_xc.a.T,_fce.c.b,null,null,2,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MinWidth"],[_xc.a.j,_xc.a.c,_xc.a.R],null,_fce.c.d,null,null,1,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MaxWidth"],[_xc.a.j,_xc.a.c,_xc.a.Q],null,_fce.c.e,null,null,1,null,null,null]],[[-1,4,null,null,null,"HeaderRegionPriority",null,_xc.a.bd,0,null,null,0,351],[-1,4,null,null,null,"ContentRegionPriority",null,_xc.a.bc,0,null,null,0,352],[-1,0,["MailModernNavigationPane"],[_xc.a.j],null,"DataContext",null,_xc.a.h,1,null,null,null]],[[-1,0,["GroupManagementHeaderViewModel"],[_xc.a.bg],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,2,["Height"],[_xc.a.bf],null,_fce.c.b,null,null,1,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_xc.a.H,0,null,null,0,2],[-1,0,["FilesContentConductor"],[_xc.a.be],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveNavigationStack",null,_xc.a.ba,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveItems",null,_xc.a.Z,1,null,null,null]]]);var r=_xc.a.b.childNodes[8].cloneNode(!0);var u=new _n.g(_j.a.a(r,[0,2]),_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));u.eD(_fce.c.a,4);u.F(39);u.z.parentNode.removeChild(u.z);var n=new _j.c(_j.a.a(r,[0,1]));n.eD(_fce.c.a,0);n.y("UnifiedGroupHeaderView");var e=new _b.m(_j.b.Instance.a(_b.i),_j.b.Instance.a(_j.o));e.U(_j.f.b(353,null,null,null,"Priority",null,_xc.a.I,0,null,null,0));e.i(!0);n.C([e]);n.z.parentNode.removeChild(n.z);var o=new _n.q(_j.a.a(r,[0,0,0]),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.f),_j.b.Instance.a(_a.x),_j.b.Instance.a(_g.h));o.a(!1);o.c(!0);var t=new _j.i(_j.a.a(r,[0,0]));t.eD(_fce.c.a,3);t.eD(_fce.c.c,!0);t.z.parentNode.removeChild(t.z);var f=new _fce.c(r.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));f.b(2);f.a.a(t);f.a.a(n);f.a.a(u);return new _j.a(r,[f,t,o,n,u])},"",_xc.j,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a)};_xc.i.registerClass("_xc.i",_h.bQ);ModernGroupsCoreComponent.registerClass("ModernGroupsCoreComponent",null,_a.jb,_j.cd);_xc.u.registerClass("_xc.u",_y.iu);_xc.d.registerClass("_xc.d",_lv.h,_xs.x,_y.iH,_y.bM,_j.br,Sys.IDisposable,_y.jt,_y.z,_bc.s,_a.jN,_y.et,_xc.x);_xc.c.registerClass("_xc.c",_lv.d);_xc.k.registerClass("_xc.k",_a.bt);_xc.j.registerClass("_xc.j",_mgn.by,_y.ei);_xc.w.registerClass("_xc.w",_db.b);_xc.h.registerClass("_xc.h",_lm.b,_rps.j,_h.C,_h.E,_h.fm,_j.br,Sys.IDisposable);_xc.o.registerClass("_xc.o",_xc.h);_xc.m.registerClass("_xc.m",_lm.e,IGroupConversationTableQuery);_xc.p.registerClass("_xc.p",_h.w);_xc.f.registerClass("_xc.f",_h.df.$$(_gg.yq,_g.dy),_h.dm);_xc.r.registerClass("_xc.r",null,_h.cO);_xc.i.a="ModernGroup";_xc.i.b="SearchModernGroup";ModernGroupsCoreComponent.$$cctor();_xc.d.b=new _h.o("ConversationLastDeliveryTime","Descending");_xc.d.d=new _a.C("GroupListView");_xc.c.a.a=null;_xc.j.a=_a.a.M;_xc.g.b=new _a.C("Missed");_xc.g.c=new _a.C("UnseenTimeout");_xc.g.a=new _h.o("ConversationLastDeliveryTime","Descending");_xc.b.h=new _a.C("Comp");_xc.b.k=new _a.C("Reply");_xc.b.i=new _a.C("PGI");_xc.b.j=new _a.C("PUGI");_xc.b.C=new _a.C("SyncD");_xc.b.A=new _a.C("USave");_xc.b.m=new _a.C("ASave");_xc.b.x=new _a.C("Att");_xc.b.g=new _j.q;_xc.b.y="NotificationTimeout";_xc.b.z="Refresh";_xc.b.d="Group_Conversation_E2E_Post";_xc.b.n="inv";_xc.b.r="bl";_xc.b.v="sl";_xc.b.o="ms";_xc.b.p="ac";_xc.b.q="as";_xc.b.s="ec";_xc.b.t="ir";_xc.b.u="sdp";_xc.b.w="sdcorrid";_xc.e.d=new RegExp("<span(?:.*?)imagepromote=(?:.*?)<\\/span>","gi");_xc.f.a="QuickComposeItemPart";_xc.a.b=_xc.a.w();_xc.a.e=null;_xc.a.f=null;_xc.a.a={};_xc.a.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupscore.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
